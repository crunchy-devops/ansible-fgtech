---
## üöÄ TEST DE CONNEXION ET DE D√âPLOIEMENT SUR LA CIBLE CENTOS 7

- name: Ex√©cuter des t√¢ches sur les h√¥tes cibles distants
  hosts: ee_test # Remplacer par le groupe/h√¥te cible
  gather_facts: false # Collecte des faits d√©sactiv√©e pour plus de rapidit√©

  tasks:
    - name: 5. Assurer l'utilisation de Python 2.7 sur l'h√¥te cible
      # Configure l'interpr√©teur pour le serveur CentOS 7 distant
      ansible.builtin.set_fact:
        ansible_python_interpreter: /usr/bin/python

    - name: 6. TEST CRITIQUE  Utiliser 'ping' pour v√©rifier la connexion SSH/Python
      ansible.builtin.ping:
      register: ping_result

    - name: Afficher le r√©sultat du ping
      ansible.builtin.debug:
        msg: "‚úÖ Connexion √† l'h√¥te cible r√©ussie (Ping: {{ ping_result.ping }})"

    - name: 7. Tester un module sp√©cifique √† CentOS 7 (yum)
      # L'absence de delegate_to garantit que cette t√¢che s'ex√©cute sur l'h√¥te cibl√©.
      ansible.builtin.yum:
        name: wget
        state: present
      register: yum_result

    - name: Confirmer le succ√®s du module 'yum'
      ansible.builtin.debug:
        msg: "‚úÖ Module 'yum' (Ansible 2.9) test√© sur l'h√¥te distant. Changement: {{ yum_result.changed }}"